---
import { getCollection, render } from "astro:content";
import Layout from "../layouts/Layout.astro";

export async function getStaticPaths() {
  const docsEntries = await getCollection("docs");
  return docsEntries.map((entry) => ({
    params: { slug: entry.id },
    props: { entry, allDocs: docsEntries },
  }));
}

const { entry, allDocs } = Astro.props;
const { Content } = await render(entry);
---

<Layout title={entry.data.title} description={entry.data.description}>
  <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-12">
    <div class="flex flex-col lg:flex-row gap-12">
      <aside class="hidden lg:block w-64 shrink-0">
        <nav class="sticky top-24">
          <h3 class="font-semibold text-zinc-900 dark:text-white mb-4">
            Navigation
          </h3>
          <ul class="space-y-3 text-sm text-zinc-600 dark:text-zinc-400">
            {
              allDocs.map((doc) => (
                <li>
                  <a
                    href={`/${doc.id}`}
                    class={`transition-colors ${entry.id === doc.id ? "text-emerald-500 dark:text-emerald-400 font-semibold" : "hover:text-zinc-900 dark:hover:text-white"}`}
                  >
                    {doc.data.title}
                  </a>
                </li>
              ))
            }
          </ul>
        </nav>
      </aside>

      <article
        class="prose dark:prose-invert prose-zinc prose-a:text-emerald-500 dark:prose-a:text-emerald-400 hover:prose-a:text-emerald-600 dark:hover:prose-a:text-emerald-300 max-w-3xl mx-auto lg:mx-0"
      >
        <h1>{entry.data.title}</h1>
        <Content />
      </article>
    </div>
  </div>
</Layout>
